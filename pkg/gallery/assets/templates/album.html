<header class="album-header">
    <nav class="breadcrumb">
        <a href="../index.html" class="back-link">‚Üê Back to Gallery</a>
    </nav>
    <h1 class="album-title">{{.Album.Title}}</h1>
    {{if .Album.Description}}
    <p class="album-description">{{.Album.Description}}</p>
    {{end}}
    {{if .Album.CreatedAt}}
    <time class="album-date" datetime="{{.Album.CreatedAt.Format "2006-01-02"}}">
        {{.Album.CreatedAt.Format "January 2, 2006"}}
    </time>
    {{end}}
</header>

<div class="masonry-grid" id="photos-grid">
    <div class="grid-sizer"></div>
    {{range .Album.Photos}}
    <div class="grid-item photo-card {{if .IsVideo}}video-item{{end}}" data-photo-id="{{.ID}}" {{if .IsVideo}}data-video-src="..{{.VideoPath}}"{{end}}>
        <a href="..{{if .IsVideo}}{{.VideoPath}}{{else}}{{if index .Thumbnails "full"}}{{index .Thumbnails "full"}}{{end}}{{end}}" class="photo-link" data-lightbox="album">
            {{if .IsVideo}}
            <div class="video-container">
                {{if index .Thumbnails "poster"}}
                <img src="..{{index .Thumbnails "poster"}}" 
                     alt="{{if .Title}}{{.Title}}{{else}}{{.Filename}}{{end}}" 
                     loading="lazy"
                     class="video-poster">
                {{else if index .Thumbnails "medium"}}
                <img src="..{{index .Thumbnails "medium"}}" 
                     alt="{{if .Title}}{{.Title}}{{else}}{{.Filename}}{{end}}" 
                     loading="lazy"
                     class="video-poster">
                {{end}}
                <video src="..{{.VideoPath}}" 
                       muted 
                       loop 
                       preload="none"
                       controlslist="nodownload nofullscreen noremoteplayback"
                       disablepictureinpicture
                       playsinline
                       crossorigin="anonymous"
                       class="video-preview"
                       style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24" width="48" height="48">
                        <path fill="white" d="M8 5v14l11-7z"/>
                    </svg>
                </div>
            </div>
            {{else}}
            {{if index .Thumbnails "medium"}}
            <img src="..{{index .Thumbnails "medium"}}" 
                 alt="{{if .Title}}{{.Title}}{{else}}{{.Filename}}{{end}}" 
                 loading="lazy">
            {{else if index .Thumbnails "small"}}
            <img src="..{{index .Thumbnails "small"}}" 
                 alt="{{if .Title}}{{.Title}}{{else}}{{.Filename}}{{end}}" 
                 loading="lazy">
            {{else if index .Thumbnails "poster"}}
            <img src="..{{index .Thumbnails "poster"}}" 
                 alt="{{if .Title}}{{.Title}}{{else}}{{.Filename}}{{end}}" 
                 loading="lazy">
            {{end}}
            {{end}}
            {{if .Title}}
            <div class="photo-overlay">
                <div class="photo-title">{{.Title}}</div>
            </div>
            {{end}}
        </a>
    </div>
    {{end}}
</div>